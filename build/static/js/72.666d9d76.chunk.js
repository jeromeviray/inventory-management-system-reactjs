(this["webpackJsonp@project/inventory-management-system"]=this["webpackJsonp@project/inventory-management-system"]||[]).push([[72],{1310:function(e,t,s){"use strict";s.r(t),s.d(t,"Checkout",(function(){return j}));var c=s(0),n=s(568),a=s(48),r=s(618),i=s(571),d=s(573),l=s(638),o=s(26),h=s(1),m=s(7);class j extends c.Component{constructor(...e){super(...e),this.state={token:"",message:"",cart:[],cartItems:[],checked:[],pendingItem:[],totalAmount:0,quantity:0},this.retrieveCartItems=()=>{this.props.getCart()},this.manageCartItemsResponse=(e,t)=>{if(e.cartResponse!==this.props.cartResponse){let{action:e,status:t,data:s}=this.props.cartResponse;"CARTITEMS"===e&&200===t&&this.setState({checked:new Array(s.cart.cartItems.length).fill(!1),cart:s.cart,cartItems:s.cart.cartItems,items:[],pendingItem:[]})}},this.handOnRemoveItem=e=>{let{token:t}=this.state;this.props.removeCartItem(e).then((()=>{this.retrieveCartItems(t)}))},this.handleOnChange=e=>{let{checked:t,pendingItem:s,cartItems:c,totalAmount:n}=this.state,a=t.map(((t,s)=>s===e?!t:t)),r=s.indexOf(c[e]);r>-1?s.splice(r,1):s.push(c[e]);let i=a.reduce(((e,t,s)=>{if(!0===t){let t;if("ONGOING"===(c[s].product.promo&&c[s].product.promo.status)){const{product:e}=c[s];console.log(c[s]);let n=e.promo.percentage,a=e.product.productPrice*n/100,r=e.product.productPrice-a;t=c[s].quantity*r}else t=c[s].amount;return e+t}return e}),0),d=a.reduce(((e,t,s)=>!0===t?e+c[s].quantity:e),0);this.setState({checked:a,totalAmount:i,quantity:d}),this.props.paymentDetailsOnChange(s,d,i)},this.manageStatus=e=>{switch(e){case"OK":return Object(m.jsx)(n.c,{color:"success",shape:"rounded-pill",children:e});case"LOW":return Object(m.jsx)(n.c,{color:"warning",shape:"rounded-pill",children:e});case"OUT_OF_STOCK":return Object(m.jsx)(n.c,{color:"danger",shape:"rounded-pill",children:"OUT OF STOCK"});default:return Object(m.jsx)(n.c,{color:"danger",shape:"rounded-pill",children:e})}},this.incrementValue=e=>{const{cartItems:t}=this.state,s=t[e].product.product.id;this.props.quantityAction("increase",s).then((()=>{this.retrieveCartItems()}))},this.decrementValue=e=>{const{cartItems:t}=this.state,s=t[e].product.product.id;this.props.quantityAction("decrease",s).then((()=>{this.retrieveCartItems()}))},this.handleQuantityOnChange=e=>{e.preventDefault();let{value:t,max:s,min:c}=e.target;t=Math.max(Number(c),Math.min(Number(s),Number(t))),this.setState({quantity:t})}}componentDidMount(){this.retrieveCartItems()}componentDidUpdate(e,t){this.manageCartItemsResponse(e,t)}render(){let{cartItems:e,checked:t}=this.state;const s={fontWeight:"800"};return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(n.s,{children:Object(m.jsxs)(n.i,{className:"mb-3 border-0",children:[Object(m.jsx)(n.m,{children:Object(m.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(m.jsx)("div",{children:Object(m.jsx)("span",{style:{...s},children:"Select"})}),Object(m.jsx)("div",{children:Object(m.jsx)("span",{style:{...s},children:"Item"})}),Object(m.jsx)("div",{children:Object(m.jsx)("span",{style:{...s},children:"Price"})}),Object(m.jsx)("div",{children:Object(m.jsx)("span",{style:{...s},children:"Quantity"})}),Object(m.jsx)("div",{children:Object(m.jsx)("span",{style:{...s},children:"Action"})})]})}),Object(m.jsx)(n.j,{children:e.length>0?e.map(((e,s)=>{const{quantity:c,addedAt:a}=e,{product:i,inventory:d,promo:l}=e.product;let j=0,u=0,p=0,O=e.amount,x=l&&l.status;"ONGOING"===x?(j=l&&l.percentage,u=i.productPrice*j/100,p=i.productPrice-u,O=c*p):O=c*i.productPrice;let b="ONGOING"===x?l.quantity:d.totalStock,g="ONGOING"!==x&&d.totalStock<=0;return!g&&c>b&&(g=!0,d.status="INSUFFICIENT STOCK"),Object(m.jsxs)(n.i,{className:t[s]?"border border-success mb-3":"mb-3",children:[Object(m.jsx)(n.j,{children:Object(m.jsxs)("div",{className:"d-flex align-items-start",children:[Object(m.jsx)("div",{className:"me-3",children:Object(m.jsx)(n.C,{color:"success",name:"checked",id:"flexCheckChecked",checked:t[s],value:e,onChange:()=>this.handleOnChange(s),disabled:g})}),Object(m.jsx)(n.M,{rounded:!0,src:i.fileImages.length>0?o.a.api.private.baseUrl+"/api/v1/products/getImages/bytesArrays/"+i.fileImages[0].path+i.fileImages[0].fileName:h.NO_IMAGE_BASE64,width:100,height:100}),Object(m.jsx)("div",{className:"ms-2  w-100",children:Object(m.jsxs)(n.bb,{className:"d-flex justify-content-between",children:[Object(m.jsx)(n.q,{className:"ps-4 text-dark",children:i.productName}),Object(m.jsx)(n.q,{className:"text-dark d-flex flex-column align-items-center",children:Object(m.jsxs)("span",{children:["\u20b1","ONGOING"===x?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("span",{className:"text-muted text-decoration-line-through me-2",style:{fontSize:"16px"},children:i.productPrice.toFixed(2)}),Object(m.jsx)("span",{children:p.toFixed(2)}),Object(m.jsx)("br",{}),Object(m.jsxs)("span",{className:"text-muted ",style:{fontSize:"16px"},children:[j+"%"," discount"]})]}):i.productPrice.toFixed(2)]})}),Object(m.jsx)(n.q,{className:"text-dark d-flex flex-column align-items-center",children:Object(m.jsxs)("div",{className:"quantity-container",children:[Object(m.jsx)(n.f,{className:"decrement-btn",type:"button",disabled:1===c,onClick:()=>this.decrementValue(s),children:Object(m.jsx)(r.c,{})}),Object(m.jsx)("input",{type:"text",className:"input-quantity",value:c,pattern:"[0-9]*",onChange:this.handleQuantityOnChange,max:"ONGOING"===x?l.quantity:d.totalStock,min:1,readOnly:!0}),Object(m.jsx)(n.f,{className:"increment-btn",disabled:c===b||b<=0,onClick:()=>this.incrementValue(s),children:Object(m.jsx)(r.h,{})})]})}),Object(m.jsx)(n.q,{className:"text-dark  d-flex justify-content-end",children:Object(m.jsx)("span",{children:Object(m.jsx)(n.p,{onClick:()=>this.handOnRemoveItem(e.id)})})})]})})]})}),Object(m.jsx)(n.k,{className:t[s]?"bg-success text-white":"",children:Object(m.jsxs)("div",{className:"d-flex justify-content-between align-items-center w-100 ",children:[Object(m.jsxs)("span",{className:"text-muted font-style",children:[Object(m.jsx)("div",{children:a}),Object(m.jsxs)("div",{children:["Stock: ",Object(m.jsx)("span",{className:"me-2",children:"ONGOING"===x?l.quantity:d.totalStock}),g?this.manageStatus(d.status):""]})]}),Object(m.jsxs)("div",{className:"d-flex align-items-center",children:[Object(m.jsx)("span",{className:"text-muted font-style me-2",children:"Amount"}),Object(m.jsxs)("span",{style:{fontWeight:"500"},children:["\u20b1",O.toFixed(2)]})]})]})})]},s)})):Object(m.jsx)(n.i,{className:"mb-3 border-0",children:Object(m.jsx)(n.j,{className:"text-center",children:"No Cart Item Added"})})})]})})})}}t.default=Object(a.b)((e=>({userResponse:e.userResponse,messageResponse:e.messageResponse,cartResponse:e.cartResponse})),{getCart:i.b,removeCartItem:i.d,clearMessage:d.a,getOrderItems:l.b,quantityAction:i.c})(j)}}]);
//# sourceMappingURL=72.666d9d76.chunk.js.map