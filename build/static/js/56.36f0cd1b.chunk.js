(this["webpackJsonp@project/inventory-management-system"]=this["webpackJsonp@project/inventory-management-system"]||[]).push([[56],{1155:function(e,t,s){"use strict";s.r(t),s.d(t,"Checkout",(function(){return u}));var a=s(0),n=s(428),c=s(55),r=s(480),i=s(434),d=s(431),o=s(503),l=s(25),m=s(2),p=s(8);class u extends a.Component{constructor(...e){super(...e),this.state={token:"",message:"",cart:[],cartItems:[],checked:[],pendingItem:[],totalAmount:0,quantity:0},this.retrieveCartItems=()=>{this.props.getCart()},this.manageCartItemsResponse=(e,t)=>{if(e.cartResponse!==this.props.cartResponse){let{action:e,status:t,data:s}=this.props.cartResponse;"CARTITEMS"===e&&200===t&&this.setState({checked:new Array(s.cart.cartItems.length).fill(!1),cart:s.cart,cartItems:s.cart.cartItems})}},this.handOnRemoveItem=e=>{let{token:t}=this.state;this.props.removeCartItem(e).then((()=>{this.retrieveCartItems(t)}))},this.handleOnChange=e=>{let{checked:t,pendingItem:s,cartItems:a}=this.state,n=t.map(((t,s)=>s===e?!t:t)),c=s.indexOf(a[e]);c>-1?s.splice(c,1):s.push(a[e]);let r=n.reduce(((e,t,s)=>{if(!0===t){let t,n=a[s].product.promo&&a[s].product.promo.status;if(console.log(a[s]),"ONGOING"===n){const{product:e}=a[s];let n=e.promo.percentage,c=e.product.productPrice*n/100,r=e.product.productPrice-c;t=a[s].quantity*r}else t=a[s].amount;return e+t}return e}),0),i=n.reduce(((e,t,s)=>!0===t?e+a[s].quantity:e),0);this.setState({checked:n,totalAmount:r,quantity:i}),this.props.paymentDetailsOnChange(s,i,r)},this.manageStatus=e=>{switch(e){case"OK":return Object(p.jsx)(n.c,{color:"success",shape:"rounded-pill",children:e});case"LOW":return Object(p.jsx)(n.c,{color:"warning",shape:"rounded-pill",children:e});case"OUT_OF_STOCK":return Object(p.jsx)(n.c,{color:"danger",shape:"rounded-pill",children:"OUT OF STOCK"});default:return Object(p.jsx)(n.c,{color:"danger",shape:"rounded-pill",children:e})}},this.incrementValue=e=>{const{cartItems:t}=this.state,s=t[e].product.product.id;this.props.quantityAction("increase",s).then((()=>{this.retrieveCartItems()}))},this.decrementValue=e=>{const{cartItems:t}=this.state,s=t[e].product.product.id;this.props.quantityAction("decrease",s).then((()=>{this.retrieveCartItems()}))},this.handleQuantityOnChange=e=>{e.preventDefault();let{value:t,max:s,min:a}=e.target;t=Math.max(Number(a),Math.min(Number(s),Number(t))),this.setState({quantity:t})}}componentDidMount(){this.retrieveCartItems()}componentDidUpdate(e,t){this.manageCartItemsResponse(e,t)}render(){let{cartItems:e,checked:t}=this.state;const s={fontWeight:"800"};return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(n.s,{children:Object(p.jsxs)(n.i,{className:"mb-3 border-0",children:[Object(p.jsx)(n.m,{children:Object(p.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(p.jsx)("div",{children:Object(p.jsx)("span",{style:{...s},children:"Select"})}),Object(p.jsx)("div",{children:Object(p.jsx)("span",{style:{...s},children:"Item"})}),Object(p.jsx)("div",{children:Object(p.jsx)("span",{style:{...s},children:"Price"})}),Object(p.jsx)("div",{children:Object(p.jsx)("span",{style:{...s},children:"Quantity"})}),Object(p.jsx)("div",{children:Object(p.jsx)("span",{style:{...s},children:"Action"})})]})}),Object(p.jsx)(n.j,{children:e.length>0?e.map(((e,s)=>{const{quantity:a,addedAt:c}=e,{product:i,inventory:d,promo:o}=e.product;let u=0,h=0,j=0,O=e.amount,b=o&&o.status;"ONGOING"===b?(u=o&&o.percentage,h=i.productPrice*u/100,j=i.productPrice-h,O=a*j):O=a*i.productPrice;let x="ONGOING"===b?o.quantity:d.totalStock,g="ONGOING"!==b&&d.totalStock<=0;return Object(p.jsxs)(n.i,{className:t[s]?"border border-success mb-3":"mb-3",children:[Object(p.jsx)(n.j,{children:Object(p.jsxs)("div",{className:"d-flex align-items-start",children:[Object(p.jsx)("div",{className:"me-3",children:Object(p.jsx)(n.C,{color:"success",name:"checked",id:"flexCheckChecked",checked:t[s],value:e,onChange:()=>this.handleOnChange(s),disabled:g})}),Object(p.jsx)(n.M,{rounded:!0,src:i.fileImages.length>0?l.a.api.private.baseUrl+"/api/v1/products/getImages/bytesArrays/"+i.fileImages[0].path+i.fileImages[0].fileName:m.NO_IMAGE_BASE64,width:100,height:100}),Object(p.jsx)("div",{className:"ms-2  w-100",children:Object(p.jsxs)(n.bb,{className:"d-flex justify-content-between",children:[Object(p.jsx)(n.q,{className:"ps-4 text-dark",children:i.productName}),Object(p.jsx)(n.q,{className:"text-dark d-flex flex-column align-items-center",children:Object(p.jsxs)("span",{children:["\u20b1","ONGOING"===b?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("span",{className:"text-muted text-decoration-line-through me-2",style:{fontSize:"16px"},children:i.productPrice.toFixed(2)}),Object(p.jsx)("span",{children:j.toFixed(2)}),Object(p.jsx)("br",{}),Object(p.jsxs)("span",{className:"text-muted ",style:{fontSize:"16px"},children:[u+"%"," discount"]})]}):i.productPrice.toFixed(2)]})}),Object(p.jsx)(n.q,{className:"text-dark d-flex flex-column align-items-center",children:Object(p.jsxs)("div",{className:"quantity-container",children:[Object(p.jsx)(n.f,{className:"decrement-btn",type:"button",disabled:1===a,onClick:()=>this.decrementValue(s),children:Object(p.jsx)(r.c,{})}),Object(p.jsx)("input",{type:"text",className:"input-quantity",value:a,pattern:"[0-9]*",onChange:this.handleQuantityOnChange,max:"ONGOING"===b?o.quantity:d.totalStock,min:1,readOnly:!0}),Object(p.jsx)(n.f,{className:"increment-btn",disabled:a===x||x<=0,onClick:()=>this.incrementValue(s),children:Object(p.jsx)(r.e,{})})]})}),Object(p.jsx)(n.q,{className:"text-dark  d-flex justify-content-end",children:Object(p.jsx)("span",{children:Object(p.jsx)(n.p,{onClick:()=>this.handOnRemoveItem(e.id)})})})]})})]})}),Object(p.jsx)(n.k,{className:t[s]?"bg-success text-white":"",children:Object(p.jsxs)("div",{className:"d-flex justify-content-between align-items-center w-100 ",children:[Object(p.jsxs)("span",{className:"text-muted font-style",children:[Object(p.jsx)("div",{children:c}),Object(p.jsxs)("div",{children:["Stock: ",Object(p.jsx)("span",{className:"me-2",children:"ONGOING"===b?o.quantity:d.totalStock}),g?this.manageStatus(d.status):""]})]}),Object(p.jsxs)("div",{className:"d-flex align-items-center",children:[Object(p.jsx)("span",{className:"text-muted font-style me-2",children:"Amount"}),Object(p.jsxs)("span",{style:{fontWeight:"500"},children:["\u20b1",O.toFixed(2)]})]})]})})]},s)})):Object(p.jsx)(n.i,{className:"mb-3 border-0",children:Object(p.jsx)(n.j,{className:"text-center",children:"No Cart Item Added"})})})]})})})}}t.default=Object(c.b)((e=>({userResponse:e.userResponse,messageResponse:e.messageResponse,cartResponse:e.cartResponse})),{getCart:i.b,removeCartItem:i.d,clearMessage:d.a,getOrderItems:o.b,quantityAction:i.c})(u)},434:function(e,t,s){"use strict";s.d(t,"a",(function(){return d})),s.d(t,"b",(function(){return o})),s.d(t,"d",(function(){return l})),s.d(t,"c",(function(){return m}));var a=s(14),n=s(2),c=s(128),r=s(56);var i=new class{addToCart(e){return r.a.post("/cart/item/add/"+e,{},{headers:Object(c.a)()})}getCart(){return r.a.get("/cart",{headers:Object(c.a)()})}removeItem(e){return r.a.delete("/cart/item/remove/"+e,{headers:Object(c.a)()})}quantityAction(e,t){return r.a.put("/cart/item/"+e+"/quantity/"+t,{},{headers:Object(c.a)()})}};const d=e=>async t=>i.addToCart(e).then((e=>(t({type:n.ADD_TO_CART,payload:{status:200,action:"ADDTOCART",data:{}}}),t({type:a.g,payload:{status:200,data:{message:"Added Successfully"}}}),Promise.resolve())),(e=>{const s=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),n=e.response&&e.response.data&&e.response.data.code||e.toString();return t({type:a.g,payload:{status:n,data:{message:s}}}),Promise.reject()})),o=()=>async e=>i.getCart().then((t=>(e({type:n.GET_CART_ITEMS,payload:{status:200,action:"CARTITEMS",data:{cart:t.data}}}),Promise.resolve())),(t=>{const s=t.response&&t.response.data&&t.response.data.message||t.message||t.toString(),n=t.response&&t.response.data&&t.response.data.code||t.toString();return e({type:a.g,payload:{status:n,data:{message:s}}}),Promise.reject()})),l=e=>async t=>i.removeItem(e).then((e=>(t({type:n.REMOVE_ITEM,payload:{status:200,action:"REMOVE",data:{}}}),t({type:a.g,payload:{status:200,data:{message:"Remove Item Successfully"}}}),Promise.resolve())),(e=>{console.log(e);const s=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),n=e.response&&e.response.data&&e.response.data.code||e.toString();return t({type:a.g,payload:{status:n,data:{message:s}}}),Promise.reject()})),m=(e,t)=>async s=>i.quantityAction(e,t).then((e=>{s({type:n.QUANTITY_ACTION,payload:{status:200,action:n.QUANTITY_ACTION,data:{}}})}),(e=>{const t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),n=e.response&&e.response.data&&e.response.data.code||e.toString();return s({type:a.g,payload:{status:n,data:{message:t}}}),Promise.reject()}))}}]);
//# sourceMappingURL=56.36f0cd1b.chunk.js.map