(this["webpackJsonp@project/inventory-management-system"]=this["webpackJsonp@project/inventory-management-system"]||[]).push([[59],{503:function(e,t,s){"use strict";s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return l})),s.d(t,"e",(function(){return p})),s.d(t,"a",(function(){return h})),s.d(t,"g",(function(){return u})),s.d(t,"f",(function(){return m})),s.d(t,"d",(function(){return j}));var a=s(2),r=s(14),n=s(128),d=s(56);var i=new class{getOrders(e){return d.a.get("/orders/status/"+e,{headers:Object(n.a)()})}getPaymentTransactions(e,t,s){return d.a.get("/orders/payments",{headers:Object(n.a)(),params:{query:e,page:t,limit:s}})}updateOrderPaymentStatus(e,t){return d.a.put("/orders/"+e+"/paid/"+t,{},{headers:Object(n.a)()})}placeOrderDetails(e){return d.a.post("/orders/checkout",{customerAddressId:e.addressId,paymentId:e.paymentMethodId,cartItems:e.items},{headers:Object(n.a)()})}getOrderByOrderId(e){return d.a.get("/orders/"+e,{headers:Object(n.a)()})}updateOrderStatus(e,t){return d.a.put("/orders/"+e+"/status/"+t,{},{headers:Object(n.a)()})}};const c=(e,t)=>{const s=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),a=e.response&&e.response.data&&e.response.data.code||e.toString();t({type:r.g,payload:{status:a,data:{message:s}}})},o=(e,t,s)=>async r=>i.getOrders(e,t,s).then((e=>(r({type:a.GET_ORDERS,payload:{status:200,action:"GET_ORDERS",data:{orders:e.data.orders,orderStatusCount:e.data.orderCounts}}}),Promise.resolve())),(e=>(c(e,r),Promise.reject()))),l=e=>async t=>{t({type:a.ORDER_ITEMS,payload:{status:200,action:"ORDERITEMS",data:{items:e}}})},p=e=>async t=>i.placeOrderDetails(e).then((e=>(t({type:a.PLACE_ORDER,payload:{status:200,action:"PLACE_ORDER",data:{}}}),t({type:r.g,payload:{status:200,data:{message:"Successfully Place your Order",order:e.data}}}),Promise.resolve())),(e=>(c(e,t),Promise.reject()))),h=e=>async t=>i.getOrderByOrderId(e).then((e=>(t({type:a.GET_ORDER_BY_ID,payload:{status:200,action:"GETORDERBYID",data:{order:e.data}}}),Promise.resolve())),(e=>(c(e,t),Promise.reject()))),u=(e,t)=>async s=>i.updateOrderStatus(e,t).then((n=>(s({type:a.UPDATE_ORDER_STATUS,payload:{status:200,action:a.UPDATE_ORDER_STATUS,data:{order:n.data}}}),s({type:r.g,payload:{status:200,data:{message:"Successfully updated order "+e+" status to "+t.toUpperCase(),order:n.data}}}),Promise.resolve())),(e=>(c(e,s),Promise.reject()))),m=(e,t)=>async s=>i.updateOrderPaymentStatus(e,t).then((e=>(s({type:a.UPDATE_PAYMENT_STATUS,payload:{status:200,action:a.UPDATE_PAYMENT_STATUS,data:{order:e.data}}}),s({type:r.g,payload:{status:200,data:{}}}),Promise.resolve())),(e=>(c(e,s),Promise.reject()))),j=(e,t,s)=>async r=>i.getPaymentTransactions(e,t,s).then((e=>(r({type:a.GET_PAYMENT_TRANSACTIONS,payload:{status:200,action:"GET_PAYMENT_TRANSACTIONS",data:{payments:e.data}}}),Promise.resolve())),(e=>(c(e,r),Promise.reject())))},676:function(e,t,s){"use strict";s.r(t),s.d(t,"Cart",(function(){return b}));var a=s(0),r=s.n(a),n=s(428),d=s(133),i=s(55),c=s(431),o=s(503),l=s(25),p=s(444),h=s(13),u=s(130),m=s(8);const j=r.a.lazy((()=>s.e(56).then(s.bind(null,1155)))),O=r.a.lazy((()=>s.e(36).then(s.bind(null,1156)))),y=r.a.lazy((()=>s.e(70).then(s.bind(null,1160)))),g=r.a.lazy((()=>s.e(69).then(s.bind(null,1157))));class b extends a.Component{constructor(...e){super(...e),this.state={step:1,items:[],Tquantity:0,Tamount:0,isLoggedIn:!1,permission:"",addressId:void 0,paymentMethodId:void 0,successfull:!1,loading:!1,redirectUrl:""},this.redirectUser=()=>{const e=this.props.userResponse.isLoggedIn;if(e){let t=this.props.userResponse.credentials.roles.roleName,s=t||this.props.userResponse.credentials.roles;this.setState({isLoggedIn:e,permission:s})}},this.handleCartOnChange=(e,t,s)=>{this.setState({items:e,Tquantity:t,Tamount:s})},this.handleAddressOnChange=e=>{this.setState({addressId:e})},this.handlePaymentMethodOnChange=e=>{this.setState({paymentMethodId:e})},this.handleOnNext=()=>{let{step:e}=this.state;3!==e&&this.setState({step:++e})},this.handleOnPre=()=>{let{step:e}=this.state;1!==e&&this.setState({step:--e})},this.renderSteps=()=>{let{step:e,addressId:t,paymentMethodId:s}=this.state,a=Object(m.jsx)(j,{paymentDetailsOnChange:this.handleCartOnChange});switch(e){case 1:return a=Object(m.jsx)(j,{paymentDetailsOnChange:this.handleCartOnChange}),a;case 2:return a=Object(m.jsx)(O,{checkValueOnChange:this.handleAddressOnChange,getValue:t}),a;case 3:return a=Object(m.jsx)(y,{paymentMethodOnChange:this.handlePaymentMethodOnChange,getValue:s}),a;default:return a}},this.renderHeader=()=>{let{step:e}=this.state,t="Shopping Cart";switch(e){case 1:return"Shopping Cart";case 2:return"Customer Address";case 3:return"Payment Method";case 4:return"";default:return t}},this.handleOnPlaceOrder=e=>{let{addressId:t,paymentMethodId:s,items:a}=this.state,r={addressId:t,paymentMethodId:s,items:a};this.setState({loading:!0}),this.props.placeOrder(r).then((()=>{let{data:e}=this.props.messageResponse;this.setState({successfull:!0,loading:!1,step:4,redirectUrl:e.order.redirectUrl})})).catch((()=>{this.setState({successfull:!1,loading:!1})}))}}componentDidMount(){if(this.props.userResponse.isLoggedIn?this.redirectUser():p.a.push(l.a.api.private.prefixFrontendUrl+"/login"),this.props.userResponse.isLoggedIn){const{orderId:e,paymentStatus:t}=this.props.match.params;"success"!=t&&"failed"!=t||this.props.updateOrderPaymentStatus(e,t),this.setState({successfull:"success"==t})}}render(){let{step:e,items:t,Tamount:s,Tquantity:r,isLoggedIn:i,permission:c,addressId:o,paymentMethodId:p,successfull:j,loading:O,redirectUrl:y}=this.state;const b={fontWeight:"800"};if(i){if(c===u.a.SUPER_ADMIN||c===u.a.ADMIN)return Object(m.jsx)(h.a,{to:l.a.api.private.prefixFrontendUrl+"/app"})}else if(!this.props.userResponse.isLoggedIn)return Object(m.jsx)(h.a,{to:l.a.api.private.prefixFrontendUrl+"/login"});return j&&""!=y&&y?(window.location.replace(y),Object(m.jsx)(m.Fragment,{})):Object(m.jsx)("div",{children:Object(m.jsxs)(a.Suspense,{fallback:Object(m.jsx)("div",{className:"d-flex justify-content-center align-items-center  position-fixed spinner",children:Object(m.jsx)(d.DotLoader,{color:"#36D7B7",size:100})}),children:[Object(m.jsx)(n.bb,{children:Object(m.jsx)("h3",{className:"mt-2 mb-4",children:this.renderHeader()})}),j?Object(m.jsx)(g,{}):Object(m.jsxs)(n.bb,{children:[Object(m.jsx)(n.q,{sm:"12",lg:"8",children:this.renderSteps()}),Object(m.jsx)(n.q,{sm:"12",lg:"4",className:"mb-5",children:Object(m.jsxs)(n.i,{children:[Object(m.jsx)(n.m,{children:Object(m.jsx)("span",{className:"",style:{fontSize:"18px",...b},children:"Summary Payment"})}),Object(m.jsxs)(n.j,{className:"border-bottom",children:[Object(m.jsxs)("div",{className:"d-flex justify-content-between bg-light p-2",children:[Object(m.jsx)("div",{children:Object(m.jsx)("span",{style:{...b},children:"Item"})}),Object(m.jsx)("div",{children:Object(m.jsx)("span",{style:{...b},children:"Amount"})})]}),t.length>0?t.map(((e,t)=>{const{promo:s,product:a}=e.product,r=s&&s.status,n=s&&s.percentage;let d=a.productPrice*n/100,i=a.productPrice-d;return"ONGOING"===r?i:a.productPrice,Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[Object(m.jsx)("span",{className:"text-truncate d-inline-block",style:{maxWidth:"150px"},children:a.productName}),Object(m.jsxs)("span",{children:["\u20b1","ONGOING"===r?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("span",{className:"text-muted text-decoration-line-through me-2",style:{fontSize:"16px"},children:a.productPrice.toFixed(2)}),Object(m.jsx)("span",{children:i.toFixed(2)})]}):a.productPrice.toFixed(2)]})]},e.id)})})):Object(m.jsx)(n.q,{style:{fontStyle:"italic",textAlign:"center"},className:"p-2",children:"No Item"})]}),Object(m.jsxs)("div",{className:"p-3 ",children:[Object(m.jsxs)("div",{className:"d-flex justify-content-between align-items-center pb-2",children:[Object(m.jsx)("span",{className:"text-muted font-style me-2",children:"Total Quantity"}),Object(m.jsx)("span",{style:{fontWeight:"500"},children:r})]}),Object(m.jsxs)("div",{className:"d-flex justify-content-between align-items-center pb-2",children:[Object(m.jsx)("span",{className:"text-muted font-style me-2",children:"Total Amount"}),Object(m.jsxs)("span",{style:{fontWeight:"500"},children:["\u20b1",s.toFixed(2)]})]})]}),Object(m.jsx)(n.k,{children:Object(m.jsx)("div",{className:"d-grid gap-2 mx-auto",children:e>1?Object(m.jsxs)("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:[Object(m.jsx)(n.f,{variant:"ghost",color:"dark",onClick:this.handleOnPre,className:"w-100",children:"Back"}),3===e?Object(m.jsxs)(n.f,{className:"w-100",color:"info",disabled:void 0===p,onClick:this.handleOnPlaceOrder,children:[O&&Object(m.jsx)(n.gb,{size:"sm",className:"ms-1"}),"Place Order"]}):Object(m.jsx)(n.f,{className:"w-100",color:"info",onClick:this.handleOnNext,disabled:void 0===o,children:"Next"})]}):Object(m.jsx)(n.f,{type:"submit",color:"info",disabled:t.length<=0,className:"d-flex justify-content-center align-items-center",onClick:this.handleOnNext,children:Object(m.jsx)("span",{className:"ms-2",children:"Checkout"})})})})]})})]})]})})}}t.default=Object(i.b)((e=>({userResponse:e.userResponse,messageResponse:e.messageResponse})),{clearMessage:c.a,placeOrder:o.e,updateOrderPaymentStatus:o.f})(b)}}]);
//# sourceMappingURL=59.6160fed3.chunk.js.map