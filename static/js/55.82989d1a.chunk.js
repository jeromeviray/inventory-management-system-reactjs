(this["webpackJsonp@project/inventory-management-system"]=this["webpackJsonp@project/inventory-management-system"]||[]).push([[55],{480:function(e,t,s){"use strict";s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return l})),s.d(t,"e",(function(){return p})),s.d(t,"a",(function(){return h})),s.d(t,"g",(function(){return u})),s.d(t,"f",(function(){return m})),s.d(t,"d",(function(){return j}));var a=s(2),r=s(21),n=s(415),d=s(88);var c=new class{getOrders(e){return d.a.get("/orders/status/"+e,{headers:Object(n.a)()})}getPaymentTransactions(e,t,s){return d.a.get("/orders/payments",{headers:Object(n.a)(),params:{query:e,page:t,limit:s}})}updateOrderPaymentStatus(e,t){return d.a.put("/orders/"+e+"/paid/"+t,{},{headers:Object(n.a)()})}placeOrderDetails(e){return d.a.post("/orders/checkout",{customerAddressId:e.addressId,paymentId:e.paymentMethodId,cartItems:e.items},{headers:Object(n.a)()})}getOrderByOrderId(e){return d.a.get("/orders/"+e,{headers:Object(n.a)()})}updateOrderStatus(e,t){return d.a.put("/orders/"+e+"/status/"+t,{},{headers:Object(n.a)()})}};const i=(e,t)=>{const s=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),a=e.response&&e.response.data&&e.response.data.code||e.toString();t({type:r.g,payload:{status:a,data:{message:s}}})},o=(e,t,s)=>async r=>c.getOrders(e,t,s).then((e=>(r({type:a.GET_ORDERS,payload:{status:200,action:"GET_ORDERS",data:{orders:e.data.orders,orderStatusCount:e.data.orderCounts}}}),Promise.resolve())),(e=>(i(e,r),Promise.reject()))),l=e=>async t=>{t({type:a.ORDER_ITEMS,payload:{status:200,action:"ORDERITEMS",data:{items:e}}})},p=e=>async t=>c.placeOrderDetails(e).then((e=>(t({type:a.PLACE_ORDER,payload:{status:200,action:"PLACE_ORDER",data:{}}}),t({type:r.g,payload:{status:200,data:{message:"Successfully Place your Order",order:e.data}}}),Promise.resolve())),(e=>(i(e,t),Promise.reject()))),h=e=>async t=>c.getOrderByOrderId(e).then((e=>(t({type:a.GET_ORDER_BY_ID,payload:{status:200,action:"GETORDERBYID",data:{order:e.data}}}),Promise.resolve())),(e=>(i(e,t),Promise.reject()))),u=(e,t)=>async s=>c.updateOrderStatus(e,t).then((n=>(s({type:a.UPDATE_ORDER_STATUS,payload:{status:200,action:a.UPDATE_ORDER_STATUS,data:{order:n.data}}}),s({type:r.g,payload:{status:200,data:{message:"Successfully updated order "+e+" status to "+t.toUpperCase(),order:n.data}}}),Promise.resolve())),(e=>(i(e,s),Promise.reject()))),m=(e,t)=>async s=>c.updateOrderPaymentStatus(e,t).then((e=>(s({type:a.UPDATE_PAYMENT_STATUS,payload:{status:200,action:a.UPDATE_PAYMENT_STATUS,data:{order:e.data}}}),s({type:r.g,payload:{status:200,data:{}}}),Promise.resolve())),(e=>(i(e,s),Promise.reject()))),j=(e,t,s)=>async r=>c.getPaymentTransactions(e,t,s).then((e=>(r({type:a.GET_PAYMENT_TRANSACTIONS,payload:{status:200,action:"GET_PAYMENT_TRANSACTIONS",data:{payments:e.data}}}),Promise.resolve())),(e=>(i(e,r),Promise.reject())))},625:function(e,t,s){"use strict";s.r(t),s.d(t,"Cart",(function(){return g}));var a=s(0),r=s.n(a),n=s(412),d=s(123),c=s(50),i=s(418),o=s(480),l=s(428),p=s(12),h=s(120),u=s(8);const m=r.a.lazy((()=>s.e(53).then(s.bind(null,1015)))),j=r.a.lazy((()=>s.e(37).then(s.bind(null,1016)))),O=r.a.lazy((()=>s.e(68).then(s.bind(null,1019)))),y=r.a.lazy((()=>s.e(67).then(s.bind(null,1017))));class g extends a.Component{constructor(...e){super(...e),this.state={step:1,items:[],Tquantity:0,Tamount:0,isLoggedIn:!1,permission:"",addressId:void 0,paymentMethodId:void 0,successfull:!1,loading:!1,redirectUrl:""},this.redirectUser=()=>{const e=this.props.userResponse.isLoggedIn;if(e){let t=this.props.userResponse.credentials.roles.roleName,s=t||this.props.userResponse.credentials.roles;this.setState({isLoggedIn:e,permission:s})}},this.handleCartOnChange=(e,t,s)=>{this.setState({items:e,Tquantity:t,Tamount:s})},this.handleAddressOnChange=e=>{this.setState({addressId:e})},this.handlePaymentMethodOnChange=e=>{this.setState({paymentMethodId:e})},this.handleOnNext=()=>{let{step:e}=this.state;3!==e&&this.setState({step:++e})},this.handleOnPre=()=>{let{step:e}=this.state;1!==e&&this.setState({step:--e})},this.renderSteps=()=>{let{step:e,addressId:t,paymentMethodId:s}=this.state,a=Object(u.jsx)(m,{paymentDetailsOnChange:this.handleCartOnChange});switch(e){case 1:return a=Object(u.jsx)(m,{paymentDetailsOnChange:this.handleCartOnChange}),a;case 2:return a=Object(u.jsx)(j,{checkValueOnChange:this.handleAddressOnChange,getValue:t}),a;case 3:return a=Object(u.jsx)(O,{paymentMethodOnChange:this.handlePaymentMethodOnChange,getValue:s}),a;default:return a}},this.renderHeader=()=>{let{step:e}=this.state,t="Shopping Cart";switch(e){case 1:return"Shopping Cart";case 2:return"Customer Address";case 3:return"Payment Method";case 4:return"";default:return t}},this.handleOnPlaceOrder=e=>{let{addressId:t,paymentMethodId:s,items:a}=this.state,r={addressId:t,paymentMethodId:s,items:a};this.setState({loading:!0}),this.props.placeOrder(r).then((()=>{let{data:e}=this.props.messageResponse;this.setState({successfull:!0,loading:!1,step:4,redirectUrl:e.order.redirectUrl})})).catch((()=>{this.setState({successfull:!1,loading:!1})}))}}componentDidMount(){if(this.props.userResponse.isLoggedIn?this.redirectUser():l.a.push("/login"),this.props.userResponse.isLoggedIn){const{orderId:e,paymentStatus:t}=this.props.match.params;"success"!=t&&"failed"!=t||this.props.updateOrderPaymentStatus(e,t),this.setState({successfull:"success"==t})}}render(){let{step:e,items:t,Tamount:s,Tquantity:r,isLoggedIn:c,permission:i,addressId:o,paymentMethodId:l,successfull:m,loading:j,redirectUrl:O}=this.state;var g=0;const b={fontWeight:"800"};if(c){if(i===h.a.SUPER_ADMIN||i===h.a.ADMIN)return Object(u.jsx)(p.a,{to:"/app"})}else if(!this.props.userResponse.isLoggedIn)return Object(u.jsx)(p.a,{to:"/login"});return m&&""!=O&&O?(window.location.replace(O),Object(u.jsx)(u.Fragment,{})):Object(u.jsx)("div",{children:Object(u.jsxs)(a.Suspense,{fallback:Object(u.jsx)("div",{className:"d-flex justify-content-center align-items-center  position-fixed ",children:Object(u.jsx)(d.DotLoader,{color:"#36D7B7",size:100})}),children:[Object(u.jsx)(n.ab,{children:Object(u.jsx)("h3",{className:"mt-2 mb-4",children:this.renderHeader()})}),m?Object(u.jsx)(y,{}):Object(u.jsxs)(n.ab,{children:[Object(u.jsx)(n.p,{sm:"12",lg:"8",children:this.renderSteps()}),Object(u.jsx)(n.p,{sm:"12",lg:"4",className:"mb-5",children:Object(u.jsxs)(n.i,{children:[Object(u.jsx)(n.m,{children:Object(u.jsx)("span",{className:"",style:{fontSize:"18px",...b},children:"Summary Payment"})}),Object(u.jsxs)(n.j,{className:"border-bottom",children:[Object(u.jsxs)("div",{className:"d-flex justify-content-between bg-light p-2",children:[Object(u.jsx)("div",{children:Object(u.jsx)("span",{style:{...b},children:"Item"})}),Object(u.jsx)("div",{children:Object(u.jsx)("span",{style:{...b},children:"Amount"})})]}),t.length>0?t.map(((e,t)=>{const{promo:s,product:a}=e.product,r=s&&s.status,n=s&&s.percentage;let d=a.productPrice*n/100,c=a.productPrice-d;return g+="ONGOING"===r?c:a.productPrice,Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[Object(u.jsx)("span",{className:"text-truncate d-inline-block",style:{maxWidth:"150px"},children:a.productName}),Object(u.jsxs)("span",{children:["\u20b1","ONGOING"===r?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("span",{className:"text-muted text-decoration-line-through me-2",style:{fontSize:"16px"},children:a.productPrice.toFixed(2)}),Object(u.jsx)("span",{children:c.toFixed(2)})]}):a.productPrice.toFixed(2)]})]},e.id)})})):Object(u.jsx)(n.p,{style:{fontStyle:"italic",textAlign:"center"},className:"p-2",children:"No Item"})]}),Object(u.jsxs)("div",{className:"p-3 ",children:[Object(u.jsxs)("div",{className:"d-flex justify-content-between align-items-center pb-2",children:[Object(u.jsx)("span",{className:"text-muted font-style me-2",children:"Total Quantity"}),Object(u.jsx)("span",{style:{fontWeight:"500"},children:r})]}),Object(u.jsxs)("div",{className:"d-flex justify-content-between align-items-center pb-2",children:[Object(u.jsx)("span",{className:"text-muted font-style me-2",children:"Total Amount"}),Object(u.jsxs)("span",{style:{fontWeight:"500"},children:["\u20b1",g.toFixed(2)]})]})]}),Object(u.jsx)(n.k,{children:Object(u.jsx)("div",{className:"d-grid gap-2 mx-auto",children:e>1?Object(u.jsxs)("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:[Object(u.jsx)(n.f,{variant:"ghost",color:"dark",onClick:this.handleOnPre,className:"w-100",children:"Back"}),3===e?Object(u.jsxs)(n.f,{className:"w-100",color:"info",disabled:void 0===l,onClick:this.handleOnPlaceOrder,children:[j&&Object(u.jsx)(n.fb,{size:"sm",className:"ms-1"}),"Place Order"]}):Object(u.jsx)(n.f,{className:"w-100",color:"info",onClick:this.handleOnNext,disabled:void 0===o,children:"Next"})]}):Object(u.jsx)(n.f,{type:"submit",color:"info",disabled:t.length<=0,className:"d-flex justify-content-center align-items-center",onClick:this.handleOnNext,children:Object(u.jsx)("span",{className:"ms-2",children:"Checkout"})})})})]})})]})]})})}}t.default=Object(c.b)((e=>({userResponse:e.userResponse,messageResponse:e.messageResponse})),{clearMessage:i.a,placeOrder:o.e,updateOrderPaymentStatus:o.f})(g)}}]);
//# sourceMappingURL=55.82989d1a.chunk.js.map