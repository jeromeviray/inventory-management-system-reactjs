(this["webpackJsonp@project/inventory-management-system"]=this["webpackJsonp@project/inventory-management-system"]||[]).push([[38],{1012:function(e,t,s){"use strict";s.r(t),s.d(t,"Orders",(function(){return u}));var a=s(0),r=s(412),n=s(120),d=s(642),o=s(480),i=s(418),c=s(51),l=s(534),p=s(121),m=(s(427),s(25)),h=s(8);class u extends a.Component{constructor(e){super(e),this.state={message:"",status:"",action:"",orders:[],token:"",permission:"",path:""},this.orderReviews={},this.manageorderRepsonse=(e,t)=>{if(e.orderResponse!==this.props.orderResponse){let{status:e,action:t,data:s}=this.props.orderResponse;200===e&&"GET_ORDERS"===t&&this.setState({orders:s.orders})}},this.manageHrefLinkBasedInPermission=e=>e===p.a.SUPER_ADMIN||e===p.a.ADMIN?"/app/order/":"/user/order/",this.state.status=e.status,this.handleOrderReview=this.handleOrderReview.bind(this)}componentDidMount(){let{type:e,accessToken:t,roles:s}=this.props.userResponse.credentials,a=e+t,r=s.roleName,n=r||s,d=this.manageHrefLinkBasedInPermission(n);this.setState({token:a,permission:s.roleName?s.roleName:s,path:d}),this.props.getOrders(this.state.status)}componentDidUpdate(e,t){this.manageorderRepsonse(e,t)}handleOrder(e,t){let s=e.orderId;this.props.updateOrderStatus(s,t).then((()=>{let a=this.state.orders;this.props.orderResponse.data;const r=a.findIndex((e=>e.orderId==s));if(a.splice(r,1),0==a.length)this.props.getOrders(this.state.status,0,10);else{let s=this.props.totalCounts;"undefined"==typeof s[t.toUpperCase()]&&(s[t.toUpperCase()]=0),s[e.orderStatus.toUpperCase()]--,s[t.toUpperCase()]++,this.props.totalCountChange(s),this.setState({orders:a})}}))}renderOrderAction(e,t){let s=Object(h.jsx)(h.Fragment,{});switch(e.toLowerCase()){case"pending":s=Object(h.jsx)(r.f,{onClick:()=>{this.handleOrder(t,"confirmed")},children:"Confirm Order"});break;case"confirmed":s=Object(h.jsx)(r.f,{onClick:()=>{this.handleOrder(t,"shipped")},children:"Mark as Shipped"});break;case"shipped":s=Object(h.jsx)(r.f,{onClick:()=>{this.handleOrder(t,"delivered")},children:"Mark as Delivered"});break;case"delivered":s=Object(h.jsx)(r.f,{onClick:()=>{this.handleOrder(t,"payment_received")},children:"Mark as Payment Received"})}return s}handleOrderView(e,t){e.preventDefault();let s=[],a=this.orderReviews[t.orderId];for(var r in a){let e=a[r];s.push({rating:e.rating,message:e.comment,anonymous:!0,published:0,product:{id:parseInt(r)},orderId:t.id})}this.props.saveComments(s).then((()=>{for(var e in a)this.orderReviews[t.orderId][e].submitted=!0}))}handleOrderReview(e,t,s,a){const{orders:r}=this.state;let n=r.findIndex((t=>t.orderId==e));const{comments:d}=r[n];let o=!1;"undefined"==typeof this.orderReviews[e]&&(this.orderReviews[e]={[t.product.id]:{rating:s,comment:a,submitted:!1}}),console.log(d);let i=d&&d.findIndex((e=>e.product.id==t.product.id));if(i>=0){const e=d[i];s=e.rating,a=e.message,o=!0}this.orderReviews[e][t.product.id]={rating:s,comment:a,submitted:o}}render(){let{message:e,orders:t,permission:s,path:a}=this.state;const d={fontSize:"14px",fontWeight:"400"};return console.log(t),Object(h.jsx)(h.Fragment,{children:0===t.length?Object(h.jsx)(r.i,{children:Object(h.jsx)(r.j,{children:Object(h.jsx)("div",{className:"text-center",children:"No Order Data"})})}):t.map(((e,t)=>{let o=e.comments.findIndex((t=>t.order_id==e.id));const i=("DELIVERED"==e.orderStatus||"PAYMENT_RECEIVED"==e.orderStatus)&&s!==p.a.SUPER_ADMIN&&s!==p.a.ADMIN,c=("DELIVERED"==e.orderStatus||"PAYMENT_RECEIVED"==e.orderStatus)&&(s==p.a.SUPER_ADMIN||s==p.a.ADMIN),{firstName:u,lastName:j,street:O,barangay:b,province:g,region:x,city:y,phoneNumber:f}=e.customerAddress;return Object(h.jsxs)(r.i,{className:"mb-3",children:[Object(h.jsx)(r.m,{children:Object(h.jsxs)(r.ab,{className:"p-2",children:[Object(h.jsxs)("span",{style:{fontSize:"14px",fontWeight:"400"},className:"text-black-50",children:["Order ID: ",e.orderId]}),Object(h.jsxs)("span",{style:{fontSize:"14px",fontWeight:"400"},className:"text-black-50",children:["Customer Name: ",u+" "+j]}),Object(h.jsxs)("span",{style:{fontSize:"14px",fontWeight:"400"},className:"text-black-50",children:["Mobile: ",f]}),Object(h.jsxs)("span",{style:{fontSize:"14px",fontWeight:"400"},className:"text-black-50",children:["Address:"," ",O+"  "+b+", "+y+", "+g]})]})}),Object(h.jsx)(r.j,{children:Object(h.jsxs)(r.A,{onSubmit:t=>{this.handleOrderView(t,e)},children:[Object(h.jsx)(r.r,{children:e.orderItems.map(((t,s)=>{this.handleOrderReview(e.orderId,t,5,"");const{rating:a,comment:r,submitted:n}=this.orderReviews[e.orderId][t.product.id];return Object(h.jsx)(l.a,{item:t,canReview:i,canViewReview:c,orderId:e.orderId,comment:r,rating:a,submitted:n,handleOrderReview:this.handleOrderReview},s)}))}),o>=0&&i&&Object(h.jsx)(r.f,{type:"submit",style:{float:"right"},children:"Submit Product Review"})]})}),Object(h.jsx)(r.k,{className:"p-4",children:Object(h.jsxs)("div",{className:"d-flex justify-content-between align-items-end",children:[Object(h.jsxs)("div",{className:"d-flex align-items-bottom",children:[Object(h.jsx)(n.b,{to:{pathname:m.a.api.private.prefixFrontendUrl+a+e.orderId,state:e.orderId},className:"m-2",children:"View More"}),s===p.a.SUPER_ADMIN||s===p.a.ADMIN?this.renderOrderAction(this.state.status,e):Object(h.jsx)(h.Fragment,{})]}),Object(h.jsxs)("div",{className:"d-flex flex-column",children:[Object(h.jsxs)("div",{style:d,className:"mt-2",children:[Object(h.jsx)("span",{className:"text-black-50 me-2",children:"Date of Ordered:"}),Object(h.jsx)("span",{style:{fontWeight:"500"},children:e.orderedAt})]}),Object(h.jsxs)("div",{style:d,className:"mt-2",children:[Object(h.jsx)("span",{style:d,className:"text-black-50 me-2",children:"Payment Method:"}),Object(h.jsx)("span",{style:{fontWeight:"500"},children:e.paymentMethod.paymentMethod})]}),Object(h.jsxs)("div",{style:d,className:"mt-2",children:[Object(h.jsx)("span",{style:d,className:"text-black-50 me-2",children:"Order Status:"}),Object(h.jsx)("span",{className:"text-danger",style:{fontWeight:"500"},children:e.orderStatus})]}),Object(h.jsxs)("div",{className:"mt-2",children:[Object(h.jsx)("span",{style:d,className:"text-black-50 me-2",children:"Total Amount"}),Object(h.jsxs)("span",{style:{fontWeight:"500"},children:["\u20b1",e.totalAmount.toFixed(2)]})]})]})]})})]},t)}))})}}t.default=Object(c.b)((e=>({orderResponse:e.orderResponse,messageResponse:e.messageResponse,userResponse:e.userResponse})),{getOrders:o.c,clearMessage:i.a,updateOrderStatus:o.g,saveComments:d.c})(u)},480:function(e,t,s){"use strict";s.d(t,"c",(function(){return c})),s.d(t,"b",(function(){return l})),s.d(t,"e",(function(){return p})),s.d(t,"a",(function(){return m})),s.d(t,"g",(function(){return h})),s.d(t,"f",(function(){return u})),s.d(t,"d",(function(){return j}));var a=s(2),r=s(21),n=s(415),d=s(89);var o=new class{getOrders(e){return d.a.get("/orders/status/"+e,{headers:Object(n.a)()})}getPaymentTransactions(e,t,s){return d.a.get("/orders/payments",{headers:Object(n.a)(),params:{query:e,page:t,limit:s}})}updateOrderPaymentStatus(e,t){return d.a.put("/orders/"+e+"/paid/"+t,{},{headers:Object(n.a)()})}placeOrderDetails(e){return d.a.post("/orders/checkout",{customerAddressId:e.addressId,paymentId:e.paymentMethodId,cartItems:e.items},{headers:Object(n.a)()})}getOrderByOrderId(e){return d.a.get("/orders/"+e,{headers:Object(n.a)()})}updateOrderStatus(e,t){return d.a.put("/orders/"+e+"/status/"+t,{},{headers:Object(n.a)()})}};const i=(e,t)=>{const s=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),a=e.response&&e.response.data&&e.response.data.code||e.toString();t({type:r.g,payload:{status:a,data:{message:s}}})},c=(e,t,s)=>async r=>o.getOrders(e,t,s).then((e=>(r({type:a.GET_ORDERS,payload:{status:200,action:"GET_ORDERS",data:{orders:e.data.orders,orderStatusCount:e.data.orderCounts}}}),Promise.resolve())),(e=>(i(e,r),Promise.reject()))),l=e=>async t=>{t({type:a.ORDER_ITEMS,payload:{status:200,action:"ORDERITEMS",data:{items:e}}})},p=e=>async t=>o.placeOrderDetails(e).then((e=>(t({type:a.PLACE_ORDER,payload:{status:200,action:"PLACE_ORDER",data:{}}}),t({type:r.g,payload:{status:200,data:{message:"Successfully Place your Order",order:e.data}}}),Promise.resolve())),(e=>(i(e,t),Promise.reject()))),m=e=>async t=>o.getOrderByOrderId(e).then((e=>(t({type:a.GET_ORDER_BY_ID,payload:{status:200,action:"GETORDERBYID",data:{order:e.data}}}),Promise.resolve())),(e=>(i(e,t),Promise.reject()))),h=(e,t)=>async s=>o.updateOrderStatus(e,t).then((n=>(s({type:a.UPDATE_ORDER_STATUS,payload:{status:200,action:a.UPDATE_ORDER_STATUS,data:{order:n.data}}}),s({type:r.g,payload:{status:200,data:{message:"Successfully updated order "+e+" status to "+t.toUpperCase(),order:n.data}}}),Promise.resolve())),(e=>(i(e,s),Promise.reject()))),u=(e,t)=>async s=>o.updateOrderPaymentStatus(e,t).then((e=>(s({type:a.UPDATE_PAYMENT_STATUS,payload:{status:200,action:a.UPDATE_PAYMENT_STATUS,data:{order:e.data}}}),s({type:r.g,payload:{status:200,data:{}}}),Promise.resolve())),(e=>(i(e,s),Promise.reject()))),j=(e,t,s)=>async r=>o.getPaymentTransactions(e,t,s).then((e=>(r({type:a.GET_PAYMENT_TRANSACTIONS,payload:{status:200,action:"GET_PAYMENT_TRANSACTIONS",data:{payments:e.data}}}),Promise.resolve())),(e=>(i(e,r),Promise.reject())))},534:function(e,t,s){"use strict";var a=s(0),r=s(412),n=s(2),d=s(431),o=s.n(d),i=s(8);class c extends a.Component{constructor(e){super(e),this.state={orderItem:this.props.item,canReview:this.props.canReview,orderId:this.props.orderId,comment:this.props.comment,rating:this.props.rating,submitted:this.props.submitted,canViewReview:this.props.canViewReview}}render(){let{orderItem:e,canReview:t,rating:s,comment:a,orderId:d,submitted:c,canViewReview:l}=this.state,p=c;l&&!t&&(c=!0);const m={fontSize:"14px",fontWeight:"400"};return Object(i.jsx)(r.ab,{className:"mb-3",children:Object(i.jsx)(r.i,{children:Object(i.jsx)(r.j,{children:Object(i.jsxs)("div",{className:"d-flex align-items-start",children:[Object(i.jsx)(r.L,{rounded:!0,src:e.product.fileImages.length>0?"/images/products/"+e.product.fileImages[0].path+e.product.fileImages[0].fileName:n.NO_IMAGE_BASE64,width:100,height:100}),Object(i.jsxs)("div",{className:"ms-2  w-100",children:[Object(i.jsxs)(r.ab,{className:"d-flex justify-content-between",children:[Object(i.jsx)(r.p,{className:"ps-4 text-dark",children:e.product.productName}),Object(i.jsxs)(r.p,{className:"text-dark d-flex flex-column align-items-center",children:[Object(i.jsx)("span",{style:m,className:"text-black-50",children:"Price"}),Object(i.jsxs)("span",{className:"pt-3",children:["\u20b1",e.product.productPrice.toFixed(2)]})]}),Object(i.jsxs)(r.p,{className:"text-dark d-flex flex-column align-items-center",children:[Object(i.jsx)("span",{style:m,className:"text-black-50",children:"Quantity"}),Object(i.jsx)("span",{className:"pt-3",children:e.quantity})]}),Object(i.jsxs)(r.p,{className:"text-dark d-flex flex-column align-items-center",children:[Object(i.jsx)("span",{style:m,className:"text-black-50",children:"Amount"}),Object(i.jsxs)("span",{className:"pt-3",children:["\u20b1",e.amount.toFixed(2)]})]})]}),(t||l&&p)&&Object(i.jsxs)("div",{children:[Object(i.jsx)(o.a,{count:5,value:s,size:24,isHalf:!1,edit:!c,onChange:t=>{this.props.handleOrderReview(d,e,t,a)}}),Object(i.jsx)("div",{className:"mb-!2",children:Object(i.jsx)("textarea",{disabled:c,onChange:t=>{this.props.handleOrderReview(d,e,s,t.target.value)},id:"exampleFormControlTextarea1",rows:"3",style:{width:"100%"},placeholder:"Please write a review.",children:a})})]})]})]})})})})}}t.a=c},642:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return c})),s.d(t,"c",(function(){return l}));var a=s(2),r=s(21),n=s(415),d=s(89);var o=new class{getComments(e,t,s){return d.a.get("/comments",{params:{productId:e,page:t,limit:s}})}saveComment(e){return d.a.post("/comments",e,{headers:Object(n.a)()})}saveComments(e){return d.a.post("/comments/bulk",e,{headers:Object(n.a)()})}deleteComment(e){return d.a.delete("/comments/"+e,{headers:Object(n.a)()})}};const i=(e,t,s)=>async n=>o.getComments(e,t,s).then((e=>(n({type:a.GET_COMMENTS,payload:{status:200,action:"GET_COMMENT",data:e.data}}),Promise.resolve())),(e=>{const t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),s=e.response&&e.response.data&&e.response.data.code||e.toString();return n({type:r.g,payload:{status:s,data:{message:t}}}),Promise.reject()})),c=e=>async t=>o.saveComment(e).then((e=>(t({type:a.ADD_COMMENT,payload:{status:200,action:"ADD_COMMENT",data:e.data}}),t({type:r.g,payload:{status:200,data:{message:"Successfully submitted product comment",order:e.data}}}),Promise.resolve())),(e=>{const s=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),a=e.response&&e.response.data&&e.response.data.code||e.toString();return t({type:r.g,payload:{status:a,data:{message:s}}}),Promise.reject()})),l=e=>async t=>o.saveComments(e).then((e=>(t({type:a.ADD_COMMENT,payload:{status:200,action:"ADD_COMMENT",data:e.data}}),t({type:r.g,payload:{status:200,data:{message:"Successfully submitted order product review",order:e.data}}}),Promise.resolve())),(e=>{const s=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),a=e.response&&e.response.data&&e.response.data.code||e.toString();return t({type:r.g,payload:{status:a,data:{message:s}}}),Promise.reject()}))}}]);
//# sourceMappingURL=38.3faa3566.chunk.js.map